<ng-template [ngIf]="dataset">
  <div style="clear: both;"></div>
  <div>
    <div>
      <mat-card [formGroup]="form" data-cy="general-info">
        <mat-card-header class="general-header">
          <div mat-card-avatar class="section-icon">
            <mat-icon> assignment </mat-icon>
          </div>
          General information
        </mat-card-header>
        <mat-card-content>
          <table>
            <tr>
              <th>Name</th>
              <td>{{ dataset.datasetName || "-" }}</td>
            </tr>
            <tr>
              <th>Description</th>
              <td>
                <span [innerHTML]="dataset.description || '-' | linky"></span>
              </td>
            </tr>
            <tr>
              <th>PID</th>
              <td>
                {{ dataset.pid }}
              </td>
            </tr>
            <tr>
              <th>Type</th>
              <td>{{dataset.type }}</td>
            </tr>
            <tr>
              <th>Creation Time</th>
              <td>{{ dataset.creationTime | date: "yyyy-MM-dd HH:mm" }}</td>
            </tr>
            <tr class="keywords-row">
              <th>Keywords</th>
              <mat-chip-set role="list" #keywordChips>
                <mat-chip role="listitem" *ngFor="let keyword of dataset.keywords">
                  {{ keyword }}
                </mat-chip>
              </mat-chip-set>
            </tr>
          </table>
        </mat-card-content>
      </mat-card>
      <mat-card>
        <mat-card-header class="creator-header">
          <div mat-card-avatar class="section-icon">
            <mat-icon>blur_linear</mat-icon>
          </div>
          Select Deposition Repository:
        </mat-card-header>

        <mat-card-content>
          <div class="deposition-info-container">
            <p class="deposition-info">
              Before proceeding with deposition, please ensure that the scientific metadata for this dataset is complete and accurate.
              You can verify look through the scientific metadata in the "Details" tab. 
              If it requires changes you can update it using the OpenEM schema.
              Please note, when SI values and units are present, you only need to make changes to the initially provided values and units, 
              convertion to SI will be done automatically, after submitting. 
            </p>
            <button
              class="ingestor"
              mat-raised-button
              color="primary"
              (click)="onChangeIngestorMetadata()"
            >
              Edit with OpenEM Schema
            </button>
          </div>


          <div class="includeIngestor">
            <!-- Display the metadata editor if clicked-->
            <app-metadata-editor
              *ngIf="showMetadataEditor"
              [data]="metadata"
              [schema]="metadataSchema"
              [renderView]="'all'"
              (dataChange)="onMetadataChange($event)"
              (errors)="onMetadataErrors($event)"
            ></app-metadata-editor>
            <button
              *ngIf="showMetadataEditor"
              class="ingestor"
              mat-raised-button
              color="primary"
              (click)="onUpdateIngestorMetadata()"
            >
              Re-submit metadata
            </button>
          </div>
          <mat-form-field class="method-name">
            <mat-label>Experimental Method</mat-label>
            <mat-select required [formControl]="depositionRepository" (selectionChange)="onChooseRepo()">
              <mat-option *ngFor="let repo of supportedDepositionList" [value]="repo.value">
                {{ repo.viewValue }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-card-content>

    

      <!------  here put scientific Metadata ------>
      </mat-card>
      <div class="deposition-cards">
        <mat-card *ngIf="selectedMethod === 'onedep'">
          <app-onedep [dataset]="dataset" [user]="user" [showFirstCard]=false></app-onedep>
        </mat-card>
        <mat-card *ngIf="selectedMethod === 'empiar'">
          <app-empiar [dataset]="dataset" [user]="user" [empiarSchemaEncoded]="empiarSchemaEncoded" [showFirstCard]=false></app-empiar>
        </mat-card>
      </div>
      
    </div>
  </div>
</ng-template>
